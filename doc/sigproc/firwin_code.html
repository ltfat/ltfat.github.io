 
<!DOCTYPE html>
<html lang="en">
<head class="include" file="../../include/header.html">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta NAME="keywords" CONTENT="gabor, wavelets, filterbank, signal processing, matlab,
octave"/>
<title>FIRWIN - FIR window</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.5/css/bootstrap-select.min.css">
<link rel="stylesheet" href="../../include/style.css" type="text/css">
<link rel="stylesheet" href="../../include/highlight.css" type="text/css">
</head>

<!-- body must stay hidden until all include parts are loaded -->
<body style="display:none;">
<!-- Wrap the content into responsive container --!>
<div class="container">
<!-- Include main navigation -->
<div class="masthead include" file="../../include/mainnav.html">
</div>
<div class="row">
    <div class="col-md-2" id="codeswitch"><div id="menutitle"><a href="firwin.html">View the help</a></div>
</div>
    <div class="col-md-offset-5 col-md-5" id="jumplist">This is where navigation should be.</div>
</div>
<div class="row">
    <div class="col-md-2">
        <div class="include" file='../include/docnav.html'></div>
        <div id="seealso"><p><div id="menutitle">See also:</div>
<ul>
<li><a href="#BASEURL#/doc/sigproc/freqwin.html">freqwin</a></li>
<li><a href="#BASEURL#/doc/fourier/pgauss.html">pgauss</a></li>
<li><a href="#BASEURL#/doc/fourier/pbspline.html">pbspline</a></li>
<li><a href="#BASEURL#/doc/sigproc/firkaiser.html">firkaiser</a></li>
<li><a href="#BASEURL#/doc/sigproc/normalize.html">normalize</a></li>
</ul>
</p></div>
    </div>
    <div class="col-md-10">

        <h1 class="title">FIRWIN - FIR window</h1>
<h2>Program code:</h2>
<div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>[g,info]<span class="p">=</span><span class="nf">firwin</span><span class="p">(</span>name,M,varargin<span class="p">)</span><span class="w"></span>
<span class="c">%FIRWIN  FIR window</span>
<span class="c">%   Usage:  g=firwin(name,M);</span>
<span class="c">%           g=firwin(name,M,...);</span>
<span class="c">%           g=firwin(name,x);</span>
<span class="c">%           </span>
<span class="c">%   FIRWIN(name,M) will return an FIR window of length M of type name.</span>
<span class="c">%</span>
<span class="c">%   All windows are symmetric and generate zero delay and zero phase</span>
<span class="c">%   filters. They can be used for the Wilson and WMDCT transform, except</span>
<span class="c">%   when noted otherwise.</span>
<span class="c">%</span>
<span class="c">%   FIRWIN(name,x) where x is a vector will sample the window</span>
<span class="c">%   definition as the specified points. The normal sampling interval for</span>
<span class="c">%   the windows is -.5&lt; x &lt;.5.</span>
<span class="c">%</span>
<span class="c">%   In the following PSL means &quot;Peak Sidelobe level&quot;, and the main lobe</span>
<span class="c">%   width is measured in normalized frequencies.</span>
<span class="c">%</span>
<span class="c">%   If a window g forms a &quot;partition of unity&quot; (PU) it means specifically</span>
<span class="c">%   that:</span>
<span class="c">%</span>
<span class="c">%     g+fftshift(g)==ones(L,1);</span>
<span class="c">%</span>
<span class="c">%   A PU can only be formed if the window length is even, but some windows</span>
<span class="c">%   may work for odd lengths anyway.</span>
<span class="c">%</span>
<span class="c">%   If a window is the square root of a window that forms a PU, the window</span>
<span class="c">%   will generate a tight Gabor frame / orthonormal Wilson/WMDCT basis if</span>
<span class="c">%   the number of channels is less than M.</span>
<span class="c">%</span>
<span class="c">%   The windows available are:</span>
<span class="c">%</span>
<span class="c">%     &#39;hann&#39;       von Hann window. Forms a PU. The Hann window has a</span>
<span class="c">%                  mainlobe with of 8/M, a PSL of -31.5 dB and decay rate</span>
<span class="c">%                  of 18 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;sine&#39;       Sine window. This is the square root of the Hanning</span>
<span class="c">%                  window. The sine window has a mainlobe width of 8/M,</span>
<span class="c">%                  a  PSL of -22.3 dB and decay rate of 12 dB/Octave.</span>
<span class="c">%                  Aliases: &#39;cosine&#39;, &#39;sqrthann&#39;</span>
<span class="c">%</span>
<span class="c">%     &#39;rect&#39;       (Almost) rectangular window. The rectangular window has a</span>
<span class="c">%                  mainlobe width of 4/M, a PSL of -13.3 dB and decay</span>
<span class="c">%                  rate of 6 dB/Octave. Forms a PU if the order is odd.</span>
<span class="c">%                  Alias: &#39;square&#39;</span>
<span class="c">%</span>
<span class="c">%     &#39;tria&#39;       (Almost) triangular window. Forms a PU. Alias: &#39;bartlett&#39;</span>
<span class="c">%</span>
<span class="c">%     &#39;sqrttria&#39;   Square root of the triangular window.</span>
<span class="c">%</span>
<span class="c">%     &#39;hamming&#39;    Hamming window. Forms a PU that sums to 1.08 instead</span>
<span class="c">%                  of 1.0 as usual. The Hamming window has a</span>
<span class="c">%                  mainlobe width of 8/M, a  PSL of -42.7 dB and decay</span>
<span class="c">%                  rate of 6 dB/Octave. This window should not be used for</span>
<span class="c">%                  a Wilson basis, as a reconstruction window cannot be</span>
<span class="c">%                  found by WILDUAL.</span>
<span class="c">%</span>
<span class="c">%     &#39;blackman&#39;   Blackman window. The Blackman window has a</span>
<span class="c">%                  mainlobe width of 12/M, a PSL of -58.1 dB and decay</span>
<span class="c">%                  rate of 18 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;blackman2&#39;  Alternate Blackman window. This window has a</span>
<span class="c">%                  mainlobe width of 12/M, a PSL of -68.24 dB and decay</span>
<span class="c">%                  rate of 6 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;itersine&#39;   Iterated sine window. Generates an orthonormal</span>
<span class="c">%                  Wilson/WMDCT basis. This window is described in </span>
<span class="c">%                  Wesfreid and Wickerhauser (1993) and is used in  the</span>
<span class="c">%                  ogg sound codec. Alias: &#39;ogg&#39;</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall&#39;    Nuttall window. The Nuttall window has a</span>
<span class="c">%                  mainlobe width of 16/M, a PSL of -93.32 dB and decay</span>
<span class="c">%                  rate of 18 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall10&#39;  2-term Nuttall window with 1 continuous derivative. </span>
<span class="c">%                  Alias: &#39;hann&#39;, &#39;hanning&#39;.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall01&#39;  2-term Nuttall window with 0 continuous derivatives. </span>
<span class="c">%                  This is a slightly improved Hamming window. It has a</span>
<span class="c">%                  mainlobe width of 8/M, a  PSL of -43.19 dB and decay</span>
<span class="c">%                  rate of 6 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall20&#39;  3-term Nuttall window with 3 continuous derivatives. </span>
<span class="c">%                  The window has a mainlobe width of 12/M, a PSL of </span>
<span class="c">%                  -46.74 dB and decay rate of 30 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall11&#39;  3-term Nuttall window with 1 continuous derivative. </span>
<span class="c">%                  The window has a mainlobe width of 12/M, a PSL of </span>
<span class="c">%                  -64.19 dB and decay rate of 18 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall02&#39;  3-term Nuttall window with 0 continuous derivatives. </span>
<span class="c">%                  The window has a mainlobe width of 12/M, a PSL of </span>
<span class="c">%                  -71.48 dB and decay rate of 6 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall30&#39;  4-term Nuttall window with 5 continuous derivatives. </span>
<span class="c">%                  The window has a mainlobe width of 16/M, a PSL of </span>
<span class="c">%                  -60.95 dB and decay rate of 42 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall21&#39;  4-term Nuttall window with 3 continuous derivatives. </span>
<span class="c">%                  The window has a mainlobe width of 16/M, a PSL of </span>
<span class="c">%                  -82.60 dB and decay rate of 30 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall12&#39;  4-term Nuttall window with 1 continuous derivatives. </span>
<span class="c">%                  Alias: &#39;nuttall&#39;.</span>
<span class="c">%</span>
<span class="c">%     &#39;nuttall03&#39;  4-term Nuttall window with 0 continuous derivatives. </span>
<span class="c">%                  The window has a mainlobe width of 16/M, a PSL of </span>
<span class="c">%                  -98.17 dB and decay rate of 6 dB/Octave.</span>
<span class="c">%</span>
<span class="c">%     &#39;truncgauss&#39; Gaussian window truncated at 1% of its height.</span>
<span class="c">%                  Alternatively, a custom percentage can be appended to</span>
<span class="c">%                  &#39;truncgauss&#39; e.g. &#39;truncgauss0.1&#39; will create Gaussian</span>
<span class="c">%                  window truncated at 0.1% of its height.</span>
<span class="c">%</span>
<span class="c">%   FIRWIN understands the following flags at the end of the list of input</span>
<span class="c">%   parameters:</span>
<span class="c">%</span>
<span class="c">%     &#39;shift&#39;,s    Shift the window by s samples. The value can be a</span>
<span class="c">%                  fractional number.</span>
<span class="c">%</span>
<span class="c">%     &#39;wp&#39;         Output is whole point even. This is the default. It</span>
<span class="c">%                  corresponds to a shift of s=0.</span>
<span class="c">%</span>
<span class="c">%     &#39;hp&#39;         Output is half point even, as most Matlab filter</span>
<span class="c">%                  routines. This corresponds to a shift of s=-.5</span>
<span class="c">%                   </span>
<span class="c">%</span>
<span class="c">%     &#39;taper&#39;,t    Extend the window by a flat section in the middle. The</span>
<span class="c">%                  argument t is the ratio of the rising and falling</span>
<span class="c">%                  parts as compared to the total length of the</span>
<span class="c">%                  window. The default value of 1 means no</span>
<span class="c">%                  tapering. Accepted values lie in the range from 0 to 1.</span>
<span class="c">%</span>
<span class="c">%   Additionally, FIRWIN accepts flags to normalize the output. Please see</span>
<span class="c">%   the help of NORMALIZE. Default is to use &#39;peak&#39; normalization,</span>
<span class="c">%   which is useful for using the output from FIRWIN for windowing in the</span>
<span class="c">%   time-domain. For filtering in the time-domain, a normalization of &#39;1&#39;</span>
<span class="c">%   or &#39;area&#39; is preferable.</span>
<span class="c">%</span>
<span class="c">%   Examples:</span>
<span class="c">%   ---------</span>
<span class="c">%</span>
<span class="c">%   The following plot shows the magnitude response for some common</span>
<span class="c">%   windows:</span>
<span class="c">%</span>
<span class="c">%     hold all; </span>
<span class="c">%     L=30;</span>
<span class="c">%     dr=110;</span>
<span class="c">%</span>
<span class="c">%     magresp(firwin(&#39;hanning&#39;,L,&#39;1&#39;),&#39;fir&#39;,&#39;dynrange&#39;,dr);</span>
<span class="c">%     magresp(firwin(&#39;hamming&#39;,L,&#39;1&#39;),&#39;fir&#39;,&#39;dynrange&#39;,dr);</span>
<span class="c">%     magresp(firwin(&#39;blackman&#39;,L,&#39;1&#39;),&#39;fir&#39;,&#39;dynrange&#39;,dr);</span>
<span class="c">%     magresp(firwin(&#39;nuttall&#39;,L,&#39;1&#39;),&#39;fir&#39;,&#39;dynrange&#39;,dr);</span>
<span class="c">%     magresp(firwin(&#39;itersine&#39;,L,&#39;1&#39;),&#39;fir&#39;,&#39;dynrange&#39;,dr);</span>
<span class="c">%</span>
<span class="c">%     legend(&#39;Hann&#39;,&#39;Hamming&#39;,&#39;Blackman&#39;,&#39;Nuttall&#39;,&#39;Itersine&#39;);</span>
<span class="c">%</span>
<span class="c">%   See also:  freqwin, pgauss, pbspline, firkaiser, normalize</span>
<span class="c">%</span>
<span class="c">%   References:</span>
<span class="c">%     A. V. Oppenheim and R. W. Schafer. Discrete-time signal processing.</span>
<span class="c">%     Prentice Hall, Englewood Cliffs, NJ, 1989.</span>
<span class="c">%     </span>
<span class="c">%     A. Nuttall. Some windows with very good sidelobe behavior. IEEE Trans.</span>
<span class="c">%     Acoust. Speech Signal Process., 29(1):84--91, 1981.</span>
<span class="c">%     </span>
<span class="c">%     F. Harris. On the use of windows for harmonic analysis with the</span>
<span class="c">%     discrete Fourier transform. Proceedings of the IEEE, 66(1):51 -- 83,</span>
<span class="c">%     jan 1978.</span>
<span class="c">%     </span>
<span class="c">%     E. Wesfreid and M. Wickerhauser. Adapted local trigonometric transforms</span>
<span class="c">%     and speech processing. IEEE Trans. Signal Process., 41(12):3596--3600,</span>
<span class="c">%     1993.</span>
<span class="c">%     </span>
<span class="c">%</span>
<span class="c">%   Url: http://ltfat.github.io/doc/sigproc/firwin.html</span>

<span class="c">% Copyright (C) 2005-2018 Peter L. Soendergaard &lt;peter@sonderport.dk&gt; and others.</span>
<span class="c">% This file is part of LTFAT version 2.5.0</span>
<span class="c">%</span>
<span class="c">% This program is free software: you can redistribute it and/or modify</span>
<span class="c">% it under the terms of the GNU General Public License as published by</span>
<span class="c">% the Free Software Foundation, either version 3 of the License, or</span>
<span class="c">% (at your option) any later version.</span>
<span class="c">%</span>
<span class="c">% This program is distributed in the hope that it will be useful,</span>
<span class="c">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c">% GNU General Public License for more details.</span>
<span class="c">%</span>
<span class="c">% You should have received a copy of the GNU General Public License</span>
<span class="c">% along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
 
<span class="c">%   AUTHORS : Peter L. Søndergaard, Nicki Holighaus.</span>
<span class="c">%   REFERENCE: NA</span>
  
<span class="k">if</span> <span class="n">nargin</span><span class="o">&lt;</span><span class="mi">2</span>
  <span class="n">error</span><span class="p">(</span><span class="s">&#39;%s: Too few input parameters.&#39;</span><span class="p">,</span><span class="n">upper</span><span class="p">(</span><span class="n">mfilename</span><span class="p">));</span>
<span class="k">end</span>

<span class="k">if</span> <span class="o">~</span><span class="n">ischar</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="n">error</span><span class="p">(</span><span class="s">&#39;%s: First input argument must the name of a window.&#39;</span><span class="p">,</span><span class="c">...</span>
        <span class="n">upper</span><span class="p">(</span><span class="n">mfilename</span><span class="p">));</span>
<span class="k">end</span>

<span class="k">if</span> <span class="o">~</span><span class="n">isnumeric</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
  <span class="n">error</span><span class="p">(</span><span class="s">&#39;%s: M must be numeric.&#39;</span><span class="p">,</span><span class="n">upper</span><span class="p">(</span><span class="n">mfilename</span><span class="p">));</span>  
<span class="k">end</span>

<span class="c">% Always set to this</span>
<span class="n">info</span><span class="p">.</span><span class="n">isfir</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>

<span class="c">% Default values, may be overwritten later in the code</span>
<span class="n">info</span><span class="p">.</span><span class="n">ispu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">info</span><span class="p">.</span><span class="n">issqpu</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>

<span class="n">name</span><span class="p">=</span><span class="n">lower</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

<span class="c">% Define initial value for flags and key/value pairs.</span>
<span class="n">definput</span><span class="p">.</span><span class="n">import</span><span class="p">={</span><span class="s">&#39;normalize&#39;</span><span class="p">};</span>
<span class="n">definput</span><span class="p">.</span><span class="n">importdefaults</span><span class="p">={</span><span class="s">&#39;null&#39;</span><span class="p">};</span>
<span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">centering</span><span class="p">={</span><span class="s">&#39;wp&#39;</span><span class="p">,</span><span class="s">&#39;hp&#39;</span><span class="p">,</span><span class="s">&#39;shift&#39;</span><span class="p">};</span>
<span class="n">definput</span><span class="p">.</span><span class="n">keyvals</span><span class="p">.</span><span class="n">shift</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>

<span class="n">definput</span><span class="p">.</span><span class="n">keyvals</span><span class="p">.</span><span class="n">taper</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>

<span class="p">[</span><span class="n">flags</span><span class="p">,</span><span class="n">kv</span><span class="p">]=</span><span class="n">ltfatarghelper</span><span class="p">({},</span><span class="n">definput</span><span class="p">,</span><span class="n">varargin</span><span class="p">,</span><span class="s">&#39;firwin&#39;</span><span class="p">);</span>

<span class="k">if</span> <span class="n">flags</span><span class="p">.</span><span class="n">do_wp</span>
  <span class="n">kv</span><span class="p">.</span><span class="n">shift</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">if</span> <span class="n">flags</span><span class="p">.</span><span class="n">do_hp</span>
  <span class="n">kv</span><span class="p">.</span><span class="n">shift</span><span class="p">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">if</span> <span class="n">M</span><span class="o">==</span><span class="mi">0</span>
  <span class="n">g</span><span class="p">=[];</span>
  <span class="k">return</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="k">if</span> <span class="nb">numel</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span>
    <span class="n">complainif_notposint</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="s">&#39;M&#39;</span><span class="p">,</span><span class="n">mfilename</span><span class="p">);</span>
    
    <span class="c">% Deal with tapering</span>
    <span class="k">if</span> <span class="n">kv</span><span class="p">.</span><span class="n">taper</span><span class="o">&lt;</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">kv</span><span class="p">.</span><span class="n">taper</span><span class="o">==</span><span class="mi">0</span>
            <span class="c">% Window is only tapering, do this and bail out, because subsequent</span>
            <span class="c">% code may fail.</span>
            <span class="n">g</span><span class="p">=</span><span class="nb">ones</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="k">end</span><span class="p">;</span>
        
        <span class="c">% Modify M to fit with tapering</span>
        <span class="n">Morig</span><span class="p">=</span><span class="n">M</span><span class="p">;</span>
        <span class="n">M</span><span class="p">=</span><span class="nb">round</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">kv</span><span class="p">.</span><span class="n">taper</span><span class="p">);</span>
        <span class="n">Mtaper</span><span class="p">=</span><span class="n">Morig</span><span class="o">-</span><span class="n">M</span><span class="p">;</span>
        
        <span class="n">p1</span><span class="p">=</span><span class="nb">round</span><span class="p">(</span><span class="n">Mtaper</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
        <span class="n">p2</span><span class="p">=</span><span class="n">Mtaper</span><span class="o">-</span><span class="n">p1</span><span class="p">;</span>
        
        <span class="c">% Switch centering if necessary</span>
        <span class="k">if</span> <span class="n">flags</span><span class="p">.</span><span class="n">do_wp</span> <span class="o">&amp;&amp;</span> <span class="n">p1</span><span class="o">~=</span><span class="n">p2</span>
            <span class="n">kv</span><span class="p">.</span><span class="n">shift</span><span class="p">=.</span><span class="mi">5</span><span class="p">;</span>
        <span class="k">end</span><span class="p">;</span>
        
        <span class="k">if</span> <span class="n">flags</span><span class="p">.</span><span class="n">do_hp</span> <span class="o">&amp;&amp;</span> <span class="n">p1</span><span class="o">~=</span><span class="n">p2</span>
            <span class="n">kv</span><span class="p">.</span><span class="n">shift</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">end</span><span class="p">;</span>
        
    <span class="k">end</span><span class="p">;</span>
    
    <span class="c">% This is the normally used sampling vector.</span>
    
    <span class="k">if</span> <span class="nb">mod</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="c">% For even M the sampling interval is [-.5,.5-1/M]</span>
        <span class="n">x</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">:.</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
    <span class="k">else</span> <span class="c">% For odd M the sampling interval is [-.5+1/(2M),.5-1/(2M)]</span>
        <span class="n">x</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">:.</span><span class="mi">5</span><span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">/</span><span class="n">M</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">+</span><span class="p">.</span><span class="mi">5</span><span class="o">/</span><span class="n">M</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">M</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
    <span class="k">end</span>
    
    <span class="n">x</span> <span class="p">=</span> <span class="n">x</span><span class="o">+</span><span class="n">kv</span><span class="p">.</span><span class="n">shift</span><span class="o">/</span><span class="n">M</span><span class="p">;</span>
    
<span class="k">else</span>
    <span class="c">% Use sampling vector specified by the user</span>
    <span class="n">x</span><span class="p">=</span><span class="n">M</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>

<span class="n">startswith</span> <span class="p">=</span> <span class="s">&#39;truncgauss&#39;</span><span class="p">;</span>
<span class="k">if</span> <span class="n">regexpi</span><span class="p">(</span><span class="n">name</span><span class="p">,[</span><span class="s">&#39;^&#39;</span><span class="p">,</span><span class="n">startswith</span><span class="p">])</span>
     <span class="n">percent</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
     <span class="k">if</span> <span class="nb">numel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">numel</span><span class="p">(</span><span class="n">startswith</span><span class="p">)</span>
            <span class="n">suffix</span> <span class="p">=</span> <span class="n">name</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">startswith</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="p">);</span>
            <span class="n">percent</span> <span class="p">=</span> <span class="n">str2double</span><span class="p">(</span><span class="n">suffix</span><span class="p">);</span>
            <span class="k">if</span> <span class="nb">isnan</span><span class="p">(</span><span class="n">percent</span><span class="p">)</span>
                <span class="n">error</span><span class="p">(</span><span class="s">&#39;%s: Passed &quot;%s&quot; and &quot;%s&quot; cannot be parsed to a number.&#39;</span><span class="p">,</span><span class="c">...</span>
                      <span class="n">upper</span><span class="p">(</span><span class="n">mfilename</span><span class="p">),</span><span class="n">name</span><span class="p">,</span><span class="n">suffix</span><span class="p">);</span>
            <span class="k">end</span>
     <span class="k">end</span>
     <span class="n">name</span> <span class="p">=</span> <span class="n">startswith</span><span class="p">;</span>
<span class="k">end</span>

<span class="n">do_sqrt</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">switch</span> <span class="n">name</span>    
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;hanning&#39;</span><span class="p">,</span><span class="s">&#39;hann&#39;</span><span class="p">,</span><span class="s">&#39;nuttall10&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=(</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">x</span><span class="p">));</span>
  <span class="n">info</span><span class="p">.</span><span class="n">ispu</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;sine&#39;</span><span class="p">,</span><span class="s">&#39;cosine&#39;</span><span class="p">,</span><span class="s">&#39;sqrthann&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="n">firwin</span><span class="p">(</span><span class="s">&#39;hanning&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">varargin</span><span class="p">{:});</span>
  <span class="n">info</span><span class="p">.</span><span class="n">issqpu</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">do_sqrt</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
  
 <span class="k">case</span> <span class="s">&#39;hamming&#39;</span>
  <span class="n">g</span><span class="p">=</span><span class="mf">0.54</span><span class="o">+</span><span class="mf">0.46</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>

  <span class="c">% This is the definition taken from the Harris paper</span>
  <span class="c">%case &#39;hammingacc&#39;</span>
  <span class="c">%g=25/46+21/46*cos(2*pi*(x));</span>

 <span class="k">case</span> <span class="s">&#39;nuttall01&#39;</span>
  <span class="n">g</span><span class="p">=</span><span class="mf">0.53836</span><span class="o">+</span><span class="mf">0.46164</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>

 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;square&#39;</span><span class="p">,</span><span class="s">&#39;rect&#39;</span><span class="p">}</span> 
  <span class="n">g</span><span class="p">=</span><span class="n">double</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">5</span><span class="p">);</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;tria&#39;</span><span class="p">,</span><span class="s">&#39;triangular&#39;</span><span class="p">,</span><span class="s">&#39;bartlett&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
  <span class="n">info</span><span class="p">.</span><span class="n">ispu</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;sqrttria&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="n">firwin</span><span class="p">(</span><span class="s">&#39;tria&#39;</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">flags</span><span class="p">.</span><span class="n">centering</span><span class="p">);</span>
  <span class="n">info</span><span class="p">.</span><span class="n">issqpu</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
  <span class="n">do_sqrt</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>

  <span class="c">% Rounded version of blackman2</span>
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;blackman&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="mf">0.42</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mf">0.08</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>

 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;blackman2&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="mi">7938</span><span class="o">/</span><span class="mi">18608</span><span class="o">+</span><span class="mi">9240</span><span class="o">/</span><span class="mi">18608</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mi">1430</span><span class="o">/</span><span class="mi">18608</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>

 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall&#39;</span><span class="p">,</span><span class="s">&#39;nuttall12&#39;</span><span class="p">}</span>
  <span class="n">g</span> <span class="p">=</span> <span class="mf">0.355768</span><span class="o">+</span><span class="mf">0.487396</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mf">0.144232</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c">...</span>
      <span class="o">+</span><span class="mf">0.012604</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;itersine&#39;</span><span class="p">,</span><span class="s">&#39;ogg&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="nb">sin</span><span class="p">(</span><span class="nb">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="nb">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
  <span class="n">info</span><span class="p">.</span><span class="n">issqpu</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall20&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>

 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall11&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="mf">0.40897</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mf">0.09103</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall02&#39;</span><span class="p">}</span>
   <span class="n">g</span><span class="p">=</span><span class="mf">0.4243801</span><span class="o">+</span><span class="mf">0.4973406</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mf">0.0782793</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
   
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall30&#39;</span><span class="p">}</span>
  <span class="n">g</span> <span class="p">=</span> <span class="mi">10</span><span class="o">/</span><span class="mi">32</span><span class="o">+</span><span class="mi">15</span><span class="o">/</span><span class="mi">32</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mi">6</span><span class="o">/</span><span class="mi">32</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">32</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
  
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall21&#39;</span><span class="p">}</span>
  <span class="n">g</span> <span class="p">=</span> <span class="mf">0.338946</span><span class="o">+</span><span class="mf">0.481973</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mf">0.161054</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c">... </span>
      <span class="o">+</span><span class="mf">0.018027</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>

 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;nuttall03&#39;</span><span class="p">}</span>
  <span class="n">g</span><span class="p">=</span><span class="mf">0.3635819</span><span class="o">+</span><span class="mf">0.4891775</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">+</span><span class="mf">0.1365995</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="c">...</span>
      <span class="o">+</span><span class="mf">0.0106411</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
 
 <span class="k">case</span> <span class="p">{</span><span class="s">&#39;truncgauss&#39;</span><span class="p">}</span>
  <span class="n">g</span> <span class="p">=</span> <span class="nb">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">log</span><span class="p">(</span><span class="n">percent</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
  
 <span class="k">otherwise</span>
  <span class="n">error</span><span class="p">(</span><span class="s">&#39;Unknown window: %s.&#39;</span><span class="p">,</span><span class="n">name</span><span class="p">);</span>
<span class="k">end</span><span class="p">;</span>

<span class="c">% Force the window to 0 outside (-.5,.5)</span>
<span class="n">g</span> <span class="p">=</span> <span class="n">g</span><span class="o">.*</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">.</span><span class="mi">5</span><span class="p">);</span>    

<span class="k">if</span> <span class="nb">numel</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">kv</span><span class="p">.</span><span class="n">taper</span><span class="o">&lt;</span><span class="mi">1</span>

    <span class="c">% Perform the actual tapering.</span>
    <span class="n">g</span><span class="p">=[</span><span class="nb">ones</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="n">g</span><span class="p">;</span><span class="nb">ones</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span>  
    
<span class="k">end</span><span class="p">;</span>   

<span class="c">% Do sqrt if needed. </span>
<span class="k">if</span> <span class="n">do_sqrt</span>
  <span class="n">g</span><span class="p">=</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="k">end</span><span class="p">;</span>

<span class="n">g</span><span class="p">=</span><span class="n">normalize</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">flags</span><span class="p">.</span><span class="n">norm</span><span class="p">);</span>
</pre></div>


        <div class="include" file="../../include/footer.html"></div>
    </div>
</div>
<!-- These two have to be here to dynamically load the included parts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script
src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.5/js/bootstrap-select.min.js"></script>
<script src="../../js/ltfat.js" type="text/javascript"></script>
<script src="../include/lookup.js" type="text/javascript"></script>
<script src="../include/jumplist.js" type="text/javascript"></script>
</body>
</html>

