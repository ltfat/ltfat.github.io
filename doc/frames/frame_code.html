 
<!DOCTYPE html>
<html lang="en">
<head class="include" file="../../include/header.html">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta NAME="keywords" CONTENT="gabor, wavelets, filterbank, signal processing, matlab,
octave"/>
<title>FRAME - Construct a new frame</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
<link rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.5/css/bootstrap-select.min.css">
<link rel="stylesheet" href="../../include/style.css" type="text/css">
<link rel="stylesheet" href="../../include/highlight.css" type="text/css">
</head>

<!-- body must stay hidden until all include parts are loaded -->
<body style="display:none;">
<!-- Wrap the content into responsive container --!>
<div class="container">
<!-- Include main navigation -->
<div class="masthead include" file="../../include/mainnav.html">
</div>
<div class="row">
    <div class="col-md-2" id="codeswitch"><div id="menutitle"><a href="frame.html">View the help</a></div>
</div>
    <div class="col-md-offset-5 col-md-5" id="jumplist">This is where navigation should be.</div>
</div>
<div class="row">
    <div class="col-md-2">
        <div class="include" file='../include/docnav.html'></div>
        <div id="seealso"><p><div id="menutitle">See also:</div>
<ul>
<li><a href="#BASEURL#/doc/frames/frana.html">frana</a></li>
<li><a href="#BASEURL#/doc/frames/frsyn.html">frsyn</a></li>
<li><a href="#BASEURL#/doc/frames/plotframe.html">plotframe</a></li>
</ul>
</p></div>
    </div>
    <div class="col-md-10">

        <h1 class="title">FRAME - Construct a new frame</h1>
<h2>Program code:</h2>
<div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span>F<span class="p">=</span><span class="nf">frame</span><span class="p">(</span>ftype,varargin<span class="p">);</span><span class="w"></span>
<span class="c">%FRAME  Construct a new frame</span><span class="w"></span>
<span class="c">%   Usage: F=frame(ftype,...);</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   F=FRAME(ftype,...) constructs a new frame object F of type</span><span class="w"></span>
<span class="c">%   ftype. Arguments following ftype are specific to the type of frame</span><span class="w"></span>
<span class="c">%   chosen.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Time-frequency frames</span><span class="w"></span>
<span class="c">%   ---------------------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;dgt&#39;,g,a,M) constructs a Gabor frame with window g,</span><span class="w"></span>
<span class="c">%   time-shift a and M channels. See the help on DGT for more</span><span class="w"></span>
<span class="c">%   information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;dgtreal&#39;,g,a,M) constructs a Gabor frame for real-valued</span><span class="w"></span>
<span class="c">%   signals with window g, time-shift a and M channels. See the help</span><span class="w"></span>
<span class="c">%   on DGTREAL for more information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;dwilt&#39;,g,M) constructs a Wilson basis with window g and M*</span><span class="w"></span>
<span class="c">%   channels. See the help on DWILT for more information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;wmdct&#39;,g,M) constructs a windowed MDCT basis with window g*</span><span class="w"></span>
<span class="c">%   and M channels. See the help on WMDCT for more information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;filterbank&#39;,g,a,M) constructs a filterbank with filters g,</span><span class="w"></span>
<span class="c">%   time-shifts of a and M channels. For the ease of implementation, it</span><span class="w"></span>
<span class="c">%   is necessary to specify M, even though it strictly speaking could be</span><span class="w"></span>
<span class="c">%   deduced from the size of the windows. See the help on FILTERBANK for</span><span class="w"></span>
<span class="c">%   more information on the parameters. Similarly, you can construct a</span><span class="w"></span>
<span class="c">%   uniform filterbank by selecting &#39;ufilterbank&#39;, a positive-frequency</span><span class="w"></span>
<span class="c">%   filterbank by selecting &#39;filterbankreal&#39; or a uniform</span><span class="w"></span>
<span class="c">%   positive-frequency filterbank by selecting &#39;ufilterbankreal&#39;.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;nsdgt&#39;,g,a,M) constructs a non-stationary Gabor frame with</span><span class="w"></span>
<span class="c">%   filters g, time-shifts of a and M channels. See the help on</span><span class="w"></span>
<span class="c">%   NSDGT for more information on the parameters. Similarly, you can</span><span class="w"></span>
<span class="c">%   construct a uniform NSDGT by selecting &#39;unsdgt&#39;, an NSDGT for</span><span class="w"></span>
<span class="c">%   real-valued signals only by selecting &#39;nsdgtreal&#39; or a</span><span class="w"></span>
<span class="c">%   uniform NSDGT for real-valued signals by selecting &#39;unsdgtreal&#39;.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Wavelet frames</span><span class="w"></span>
<span class="c">%   --------------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;fwt&#39;, w, J) constructs a wavelet frame with wavelet definition </span><span class="w"></span>
<span class="c">%   w and J number of filterbank iterations. Similarly, a redundant time </span><span class="w"></span>
<span class="c">%   invariant wavelet representation can be constructed by selecting &#39;ufwt&#39;.</span><span class="w"></span>
<span class="c">%   See the help on FWT and UFWT for more information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;wfbt&#39;, wt) constructs a wavelet filterbank tree defined by</span><span class="w"></span>
<span class="c">%   the wavelet filterbank tree definition wt. Similarly, an undecimated</span><span class="w"></span>
<span class="c">%   wavelet filterbank tree can be constructed by selecting &#39;uwfbt&#39;. See the</span><span class="w"></span>
<span class="c">%   help on WFBT and UWFBT for more information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;wpfbt&#39;, wt) constructs a wavelet packet filterbank tree </span><span class="w"></span>
<span class="c">%   defined by the wavelet filterbank tree definition wt. Similarly, an</span><span class="w"></span>
<span class="c">%   undecimated wavelet packet filterbank tree can be constructed by selecting</span><span class="w"></span>
<span class="c">%   &#39;uwpfbt&#39;. See the help on WPFBT and UWPFBT for more information.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Pure frequency frames</span><span class="w"></span>
<span class="c">%   ---------------------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;dft&#39;) constructs a basis where the analysis operator is the</span><span class="w"></span>
<span class="c">%   DFT, and the synthesis operator is its inverse, IDFT. Completely</span><span class="w"></span>
<span class="c">%   similar to this, you can enter the name of any of the cosine or sine</span><span class="w"></span>
<span class="c">%   transforms DCTI, DCTII, DCTIII, DCTIV, DSTI, DSTII,</span><span class="w"></span>
<span class="c">%   DSTIII or DSTIV.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;reddft&#39;,red) constructs so called harmonic Parseval tight</span><span class="w"></span>
<span class="c">%   frame or redundant dft with redundancy red. The frame accepts any </span><span class="w"></span>
<span class="c">%   red, but FRANA will only work for signal lengths Ls for which </span><span class="w"></span>
<span class="c">%   the number of coefficients Ls*red is an integer.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;dftreal&#39;) constructs a normalized FFTREAL basis for</span><span class="w"></span>
<span class="c">%   real-valued signals of even length only. The basis is normalized</span><span class="w"></span>
<span class="c">%   to ensure that is it orthonormal.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Special / general frames</span><span class="w"></span>
<span class="c">%   ------------------------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;gen&#39;,g) constructs a general frame with a synthesis matrix g.</span><span class="w"></span>
<span class="c">%   The frame atoms must be stored as column vectors in the matrix.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;identity&#39;) constructs the canonical orthonormal basis, meaning</span><span class="w"></span>
<span class="c">%   that all operators return their input as output, so it is the dummy</span><span class="w"></span>
<span class="c">%   operation.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Container frames</span><span class="w"></span>
<span class="c">%   ----------------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;fusion&#39;,w,F1,F2,...) constructs a fusion frame, which is</span><span class="w"></span>
<span class="c">%   the collection of the frames specified by F1, F2,... The vector</span><span class="w"></span>
<span class="c">%   w contains a weight for each frame. If w is a scalar, this weight</span><span class="w"></span>
<span class="c">%   will be applied to all the sub-frames.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;tensor&#39;,F1,F2,...) constructs a tensor product frame, where the</span><span class="w"></span>
<span class="c">%   frames F1, F2,... are applied along the 1st, 2nd etc. dimensions. If</span><span class="w"></span>
<span class="c">%   you don&#39;t want any action along a specific dimension, use the identity</span><span class="w"></span>
<span class="c">%   frame along that dimension. Any remaining dimensions in the input</span><span class="w"></span>
<span class="c">%   signal are left alone.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Wrapper frames</span><span class="w"></span>
<span class="c">%   --------------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Frames types in this section are &quot;virtual&quot;. They serve as a wrapper for</span><span class="w"></span>
<span class="c">%   a different type of frame.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;erbletfb&#39;,fs,Ls,...) constructs an Erb-let filterbank frame for</span><span class="w"></span>
<span class="c">%   a given samp. frequency fs working with signals of length Ls. See</span><span class="w"></span>
<span class="c">%   ERBFILTERS for a description of additional parameters as all </span><span class="w"></span>
<span class="c">%   parameters other than the frame type string &#39;erbletfb&#39; are passed to it.</span><span class="w"></span>
<span class="c">%   NOTE: The resulting frame is defined only for a single signal length</span><span class="w"></span>
<span class="c">%   Ls. Shorter signals will be zero-padded, signals longer than Ls*</span><span class="w"></span>
<span class="c">%   cannot be processed.</span><span class="w"></span>
<span class="c">%   The actual frame type is &#39;filterbank&#39; or &#39;filterbankreal&#39;.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   FRAME(&#39;cqtfb&#39;,fs,fmin,fmax,bins,Ls,...) constructs a CQT filterbank </span><span class="w"></span>
<span class="c">%   frame for a given samp. frequency fs working with signals of length </span><span class="w"></span>
<span class="c">%   Ls. See CQTFILTERS for a description of other parameters.</span><span class="w"></span>
<span class="c">%   NOTE: The resulting frame is defined only for a single signal length</span><span class="w"></span>
<span class="c">%   Ls. Shorter signals will be zero-padded, signals longer than Ls*</span><span class="w"></span>
<span class="c">%   cannot be processed.</span><span class="w"></span>
<span class="c">%   The actual frame type is &#39;filterbank&#39; or &#39;filterbankreal&#39;.</span><span class="w"></span>
<span class="c">%  </span><span class="w"></span>
<span class="c">%   Examples</span><span class="w"></span>
<span class="c">%   --------</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   The following example creates a Modified Discrete Cosine Transform frame,</span><span class="w"></span>
<span class="c">%   analyses an input signal and plots the frame coefficients:</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%      F=frame(&#39;wmdct&#39;,&#39;gauss&#39;,40);</span><span class="w"></span>
<span class="c">%      c=frana(F,greasy);</span><span class="w"></span>
<span class="c">%      plotframe(F,c,&#39;dynrange&#39;,60);</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   See also: frana, frsyn, plotframe</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">%   Url: http://ltfat.github.io/doc/frames/frame.html</span><span class="w"></span>

<span class="c">% Copyright (C) 2005-2023 Peter L. Soendergaard &lt;peter@sonderport.dk&gt; and others.</span><span class="w"></span>
<span class="c">% This file is part of LTFAT version 2.6.0</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">% This program is free software: you can redistribute it and/or modify</span><span class="w"></span>
<span class="c">% it under the terms of the GNU General Public License as published by</span><span class="w"></span>
<span class="c">% the Free Software Foundation, either version 3 of the License, or</span><span class="w"></span>
<span class="c">% (at your option) any later version.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">% This program is distributed in the hope that it will be useful,</span><span class="w"></span>
<span class="c">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span><span class="w"></span>
<span class="c">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><span class="w"></span>
<span class="c">% GNU General Public License for more details.</span><span class="w"></span>
<span class="c">%</span><span class="w"></span>
<span class="c">% You should have received a copy of the GNU General Public License</span><span class="w"></span>
<span class="c">% along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span><span class="w"></span>

<span class="w">  </span>
<span class="n">complainif_notenoughargs</span><span class="p">(</span><span class="nb">nargin</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;FRAME&#39;</span><span class="p">);</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">ischar</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="nb">error</span><span class="p">([</span><span class="s">&#39;%s: First argument must be a string denoting the type of &#39;</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">         </span><span class="s">&#39;frame.&#39;</span><span class="p">],</span><span class="nb">upper</span><span class="p">(</span><span class="nb">mfilename</span><span class="p">));</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="n">ftype</span><span class="p">=</span><span class="nb">lower</span><span class="p">(</span><span class="n">ftype</span><span class="p">);</span><span class="w"></span>

<span class="c">% True if the frame only works with real-valued input.</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">realinput</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="c">% True if the frame only works with a fixed length.</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">fixedlength</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="c">% Handle the windowed transforms</span><span class="w"></span>
<span class="k">switch</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span><span class="w"></span>
<span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;dgt&#39;</span><span class="p">,</span><span class="s">&#39;dwilt&#39;</span><span class="p">,</span><span class="s">&#39;wmdct&#39;</span><span class="p">,</span><span class="s">&#39;filterbank&#39;</span><span class="p">,</span><span class="s">&#39;ufilterbank&#39;</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">       </span><span class="s">&#39;nsdgt&#39;</span><span class="p">,</span><span class="s">&#39;unsdgt&#39;</span><span class="p">,</span><span class="s">&#39;wfbt&#39;</span><span class="p">,</span><span class="s">&#39;uwfbt&#39;</span><span class="p">,</span><span class="s">&#39;wpfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span>
<span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;dgtreal&#39;</span><span class="p">,</span><span class="s">&#39;filterbankreal&#39;</span><span class="p">,</span><span class="s">&#39;ufilterbankreal&#39;</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">      </span><span class="s">&#39;nsdgtreal&#39;</span><span class="p">,</span><span class="s">&#39;unsdgtreal&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="n">F</span><span class="p">.</span><span class="n">realinput</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span>
<span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;fwt&#39;</span><span class="p">,</span><span class="s">&#39;ufwt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="n">complainif_notposint</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">,</span><span class="s">&#39;J&#39;</span><span class="p">,</span><span class="s">&#39;FRAME&#39;</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="c">% Input param checking</span><span class="w"></span>
<span class="k">switch</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;fusion&#39;</span><span class="w"></span>
<span class="w">     </span><span class="n">wtmp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">     </span><span class="c">% Check w </span><span class="w"></span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">isnumeric</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">})</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">        </span><span class="o">~</span><span class="p">(</span><span class="nb">isscalar</span><span class="p">(</span><span class="n">wtmp</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">wtmp</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="nb">varargin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="w">       </span><span class="nb">error</span><span class="p">(</span><span class="s">&#39;%s: Weights are not in a correct format.&#39;</span><span class="p">,</span><span class="nb">upper</span><span class="p">(</span><span class="nb">mfilename</span><span class="p">));</span><span class="w"></span>
<span class="w">     </span><span class="k">end</span><span class="w"></span>
<span class="w">     </span>
<span class="w">     </span><span class="c">% Check frame objects</span><span class="w"></span>
<span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="n">ii</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="nb">varargin</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">complainif_notvalidframeobj</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{</span><span class="n">ii</span><span class="p">},</span><span class="s">&#39;FRAME&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="k">end</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;tensor&#39;</span><span class="w"></span>
<span class="w">     </span><span class="c">% Check frame objects</span><span class="w"></span>
<span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="n">ii</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="nb">numel</span><span class="p">(</span><span class="nb">varargin</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">complainif_notvalidframeobj</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{</span><span class="n">ii</span><span class="p">},</span><span class="s">&#39;FRAME&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">     </span><span class="k">end</span><span class="w">        </span>
<span class="k">end</span><span class="w"></span>


<span class="c">% For parsing optional parameters to the transforms.</span><span class="w"></span>
<span class="n">vargs</span><span class="p">={};</span><span class="w"></span>
<span class="n">definput</span><span class="p">=</span><span class="nb">struct</span><span class="p">();</span><span class="w"></span>

<span class="c">%% ---- Pre-optional parameters</span><span class="w"></span>
<span class="c">% Common operations to deal with the input parameters.</span><span class="w"></span>
<span class="k">switch</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;dgt&#39;</span><span class="p">,</span><span class="s">&#39;dgtreal&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">3</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">vargs</span><span class="p">=</span><span class="nb">varargin</span><span class="p">(</span><span class="mi">4</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">keyvals</span><span class="p">.</span><span class="n">lt</span><span class="p">=[</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">phase</span><span class="p">={</span><span class="s">&#39;freqinv&#39;</span><span class="p">,</span><span class="s">&#39;timeinv&#39;</span><span class="p">};</span><span class="w">    </span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;dwilt&#39;</span><span class="p">,</span><span class="s">&#39;wmdct&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;filterbank&#39;</span><span class="p">,</span><span class="s">&#39;ufilterbank&#39;</span><span class="p">,</span><span class="s">&#39;filterbankreal&#39;</span><span class="p">,</span><span class="s">&#39;ufilterbankreal&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">3</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">]=</span><span class="n">comp_filterbank_a</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="nb">struct</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;nsdgt&#39;</span><span class="p">,</span><span class="s">&#39;unsdgt&#39;</span><span class="p">,</span><span class="s">&#39;nsdgtreal&#39;</span><span class="p">,</span><span class="s">&#39;unsdgtreal&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">3</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="c">% Sanitize &#39;a&#39; and &#39;M&#39;. Make M a column vector of length N,</span><span class="w"></span>
<span class="w">    </span><span class="c">% where N is determined from the length of &#39;a&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">=</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">N</span><span class="p">=</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">=</span><span class="nb">bsxfun</span><span class="p">(@</span><span class="n">times</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">(:),</span><span class="nb">ones</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;ufwt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">vargs</span><span class="p">=</span><span class="nb">varargin</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">={</span><span class="s">&#39;sqrt&#39;</span><span class="p">,</span><span class="s">&#39;noscale&#39;</span><span class="p">,</span><span class="s">&#39;scale&#39;</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;uwfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">vargs</span><span class="p">=</span><span class="nb">varargin</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">={</span><span class="s">&#39;sqrt&#39;</span><span class="p">,</span><span class="s">&#39;noscale&#39;</span><span class="p">,</span><span class="s">&#39;scale&#39;</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;wpfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">vargs</span><span class="p">=</span><span class="nb">varargin</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">interscaling</span><span class="p">={</span><span class="s">&#39;intsqrt&#39;</span><span class="p">,</span><span class="s">&#39;intnoscale&#39;</span><span class="p">,</span><span class="s">&#39;intscale&#39;</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;uwpfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">vargs</span><span class="p">=</span><span class="nb">varargin</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">interscaling</span><span class="p">={</span><span class="s">&#39;intsqrt&#39;</span><span class="p">,</span><span class="s">&#39;intnoscale&#39;</span><span class="p">,</span><span class="s">&#39;intscale&#39;</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">definput</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">={</span><span class="s">&#39;sqrt&#39;</span><span class="p">,</span><span class="s">&#39;noscale&#39;</span><span class="p">,</span><span class="s">&#39;scale&#39;</span><span class="p">};</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>

<span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">]=</span><span class="n">ltfatarghelper</span><span class="p">({},</span><span class="n">definput</span><span class="p">,</span><span class="n">vargs</span><span class="p">);</span><span class="w"></span>

<span class="n">F</span><span class="p">.</span><span class="n">type</span><span class="p">=</span><span class="n">ftype</span><span class="p">;</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">origargs</span><span class="p">=</span><span class="nb">varargin</span><span class="p">;</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">vargs</span><span class="p">=</span><span class="n">vargs</span><span class="p">;</span><span class="w"></span>


<span class="c">%% ------ Post optional parameters</span><span class="w"></span>

<span class="c">% Default value, works for all bases</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="c">% Default value, frame works for all lengths</span><span class="w"></span>
<span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">Ls</span><span class="p">;</span><span class="w"></span>

<span class="k">switch</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;gen&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="o">&#39;*</span><span class="n">insig</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="o">*</span><span class="n">insig</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">size</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;identity&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">insig</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">insig</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dft&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dft</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">idft</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;reddft&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">nargin</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"> </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">isscalar</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">        </span><span class="nb">error</span><span class="p">(</span><span class="s">&#39;%s: Redundancy must be greater or equal to 1.&#39;</span><span class="p">,</span><span class="nb">upper</span><span class="p">(</span><span class="nb">mfilename</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dft</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="w">     </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">postpad</span><span class="p">(</span><span class="n">idft</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="n">Ncoef</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">clength</span><span class="w">   </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="n">L</span><span class="o">*</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dftreal&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">fftreal</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">ifftreal</span><span class="p">(</span><span class="n">insig</span><span class="p">,(</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">((</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="nb">ceil</span><span class="p">(</span><span class="n">Ls</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">Ncoef</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">realinput</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">clength</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="nb">floor</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dcti&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dcti</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dcti</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dctii&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dctii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dctiii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dctiii&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dctiii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dctii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dctiv&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dctiv</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dctiv</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dsti&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dsti</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dsti</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dstii&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dstii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dstiii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dstiii&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dstiii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dstii</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dstiv&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dstiv</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">dstiv</span><span class="p">(</span><span class="n">insig</span><span class="p">,[],</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dgt&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_dgt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="n">lt</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">do_timeinv</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_idgt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="n">lt</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">do_timeinv</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">dgtlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="n">lt</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dgtreal&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">                                                      </span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_dgtreal</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="n">lt</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">do_timeinv</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_idgtreal</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="n">lt</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">do_timeinv</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">dgtlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">kv</span><span class="p">.</span><span class="n">lt</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="n">Ncoef</span><span class="o">/</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">clength</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="n">L</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;dwilt&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_dwilt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_idwilt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">dwiltlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;wmdct&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_dwiltiii</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_idwiltiii</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w">  </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">dwiltlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">);</span><span class="w">        </span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;filterbank&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">filterbanklength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="n">Ncoef</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">cell2mat</span><span class="p">(</span><span class="n">coef</span><span class="p">(:));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">vect2cell</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="o">*</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_filterbank</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_ifilterbank</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                      </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">destructor</span><span class="p">=@()</span><span class="w"> </span><span class="nb">clear</span><span class="p">(</span><span class="s">&#39;comp_filterbank&#39;</span><span class="p">,</span><span class="s">&#39;comp_ifilterbank&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;filterbankreal&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="mi">2</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">filterbanklength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Ncoef</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">cell2mat</span><span class="p">(</span><span class="n">coef</span><span class="p">(:));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">vect2cell</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="o">*</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_filterbank</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">real</span><span class="p">(</span><span class="n">comp_ifilterbank</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                             </span><span class="nb">round</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">destructor</span><span class="p">=@()</span><span class="w"> </span><span class="nb">clear</span><span class="p">(</span><span class="s">&#39;comp_filterbank&#39;</span><span class="p">,</span><span class="s">&#39;comp_ifilterbank&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;ufilterbank&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">filterbanklength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">Ncoef</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">ufilterbank</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">ifilterbank</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w">   </span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;ufilterbankreal&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="mi">2</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">2</span><span class="p">)</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">(:,</span><span class="mi">1</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">filterbanklength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">round</span><span class="p">(</span><span class="n">Ncoef</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">ufilterbank</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">real</span><span class="p">(</span><span class="n">ifilterbank</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">                                        </span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;nsdgt&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">mat2cell</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">cell2mat</span><span class="p">(</span><span class="n">coef</span><span class="p">(:));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">nsdgt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">insdgt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;unsdgt&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">unsdgt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">insdgt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w">    </span>

<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;nsdgtreal&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">mat2cell</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">cell2mat</span><span class="p">(</span><span class="n">coef</span><span class="p">(:));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">nsdgtreal</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">insdgtreal</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">clength</span><span class="p">=@(</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;unsdgtreal&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">=@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">                                    </span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">=@(</span><span class="n">coef</span><span class="p">)</span><span class="w">   </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">unsdgtreal</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">insdgtreal</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">a</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">clength</span><span class="p">=@(</span><span class="n">L</span><span class="p">)</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">floor</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">                </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;fusion&#39;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">w</span><span class="p">=</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">=</span><span class="nb">varargin</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">fEl</span><span class="p">)</span><span class="w"> </span><span class="n">fEl</span><span class="p">.</span><span class="n">realinput</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">))</span><span class="w"></span>
<span class="w">        </span><span class="nb">error</span><span class="p">([</span><span class="s">&#39;%s: Real-valued-input-only frames are not currently &#39;</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">               </span><span class="s">&#39;supported in the fusion frame.&#39;</span><span class="p">],</span><span class="nb">upper</span><span class="p">(</span><span class="nb">mfilename</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">Nframes</span><span class="p">=</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">w</span><span class="p">=</span><span class="nb">bsxfun</span><span class="p">(@</span><span class="n">times</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">w</span><span class="p">(:),</span><span class="nb">ones</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">Nframes</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span><span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">comp_framelength_fusion</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Ls</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">sum</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@</span><span class="n">framered</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="c">% These definitions binds F itself, so they must execute last</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_frana_fusion</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">insig</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_frsyn_fusion</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">insig</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;tensor&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c">% This frame type is currently broken. It must be reworked to reshape</span><span class="w"></span>
<span class="w">    </span><span class="c">% to the standard layout in order not to break all the assumptions.</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">=</span><span class="nb">varargin</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">Nframes</span><span class="p">=</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">ii</span><span class="p">=</span><span class="mi">1</span><span class="p">:</span><span class="n">F</span><span class="p">.</span><span class="n">Nframes</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">{</span><span class="n">ii</span><span class="p">}.</span><span class="n">realinput</span><span class="w"></span>
<span class="w">            </span><span class="nb">error</span><span class="p">([</span><span class="s">&#39;It is not safe to embed a real-valued-input-only frame &#39;</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">                   </span><span class="s">&#39;into the tensor frame.&#39;</span><span class="p">]);</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_frana_tensor</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">insig</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_frsyn_tensor</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">insig</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">comp_framelength_tensor</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Ls</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="nb">prod</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@</span><span class="n">framered</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">frames</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;fwt&#39;</span><span class="p">,</span><span class="s">&#39;dwt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="c">% We have to initialize F.g here already</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">info</span><span class="p">]=</span><span class="n">fwtinit</span><span class="p">({</span><span class="s">&#39;strict&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>^<span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.^</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">wavcell2pack</span><span class="p">(</span><span class="n">comp_fwt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">h</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">,</span><span class="s">&#39;per&#39;</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_ifwt</span><span class="p">(</span><span class="k">...</span><span class="w"></span>
<span class="w">                        </span><span class="n">wavpack2cell</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">fwtclength</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                               </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="s">&#39;per&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">fwtlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;wfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">info</span><span class="p">]=</span><span class="n">wfbtinit</span><span class="p">({</span><span class="s">&#39;strict&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="n">treeSub</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="c">% comp_ specific</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">treeBFranges</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">wavpack2cell</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="n">wfbtclength</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="n">wavcell2pack</span><span class="p">(</span><span class="n">coef</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_wfbt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                             </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">,</span><span class="s">&#39;per&#39;</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_iwfbt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                </span><span class="p">[</span><span class="n">nodesInLen</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">],</span><span class="k">...</span><span class="w"></span>
<span class="w">                                </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                </span><span class="s">&#39;per&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">wfbtlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;wpfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="n">wfbtinit</span><span class="p">({</span><span class="s">&#39;strict&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">aEl</span><span class="p">)</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="n">aEl</span><span class="p">),</span><span class="n">nodesSub</span><span class="p">(</span><span class="n">nodeBForder</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="c">% comp_ specific</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nodeBForder</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nodesLocOutRange</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">pOutIdxs</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">chOutIdxs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">treeWpBFrange</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">wavpack2cell</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                    </span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">./</span><span class="nb">cell2mat</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">aEl</span><span class="p">)</span><span class="w"> </span><span class="n">aEl</span><span class="p">(:),</span><span class="k">...</span><span class="w"></span>
<span class="w">                    </span><span class="nb">reshape</span><span class="p">(</span><span class="n">nodesSub</span><span class="p">(</span><span class="n">nodeBForder</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">),[],</span><span class="mi">1</span><span class="p">),</span><span class="k">...</span><span class="w"></span>
<span class="w">                    </span><span class="s">&#39;UniformOutput&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">./</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="n">wavcell2pack</span><span class="p">(</span><span class="n">coef</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="k">...</span><span class="w"></span>
<span class="w">                        </span><span class="n">comp_wpfbt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                   </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">,</span><span class="s">&#39;per&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">interscaling</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_iwpfbt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="n">F</span><span class="p">.</span><span class="n">pOutIdxs</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">chOutIdxs</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="s">&#39;per&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">interscaling</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">wfbtlength</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;ufwt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="n">fwtinit</span><span class="p">({</span><span class="s">&#39;strict&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="o">*</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="o">*</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="n">comp_ufwt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">h</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_iufwt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">g</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">Ls</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">=(</span><span class="n">F</span><span class="p">.</span><span class="n">J</span><span class="o">*</span><span class="p">(</span><span class="nb">numel</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;uwfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="n">wfbtinit</span><span class="p">({</span><span class="s">&#39;strict&#39;</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">});</span><span class="w"></span>

<span class="w">    </span><span class="c">% comp_ specific</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">treeBFranges</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">nodesUps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nodesFiltUps</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@</span><span class="nb">numel</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="k">...</span><span class="w"></span>
<span class="w">                        </span><span class="n">comp_uwfbt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">nodesUps</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                   </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_iuwfbt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="n">F</span><span class="p">.</span><span class="n">nodesUps</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                 </span><span class="n">F</span><span class="p">.</span><span class="n">rangeOut</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">Ls</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;uwpfbt&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">=</span><span class="w"> </span><span class="n">wfbtinit</span><span class="p">({</span><span class="s">&#39;strict&#39;</span><span class="p">,</span><span class="nb">varargin</span><span class="p">{</span><span class="mi">1</span><span class="p">}});</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">fEl</span><span class="p">)</span><span class="w"> </span><span class="nb">numel</span><span class="p">(</span><span class="n">fEl</span><span class="p">.</span><span class="n">g</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="c">% comp_ specific</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nodeBForder</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">nodesUps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nodesFiltUps</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">nodesLocOutRange</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">F</span><span class="p">.</span><span class="n">pOutIdxs</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">chOutIdxs</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">treeWpBFrange</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">red</span><span class="p">,</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">@(</span><span class="n">coef</span><span class="p">)</span><span class="w"> </span><span class="nb">reshape</span><span class="p">(</span><span class="n">coef</span><span class="p">,[</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">size</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="mi">3</span><span class="p">)]);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frana</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">native2coef</span><span class="p">(</span><span class="k">...</span><span class="w"></span>
<span class="w">                        </span><span class="n">comp_uwpfbt</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">rangeLoc</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                    </span><span class="n">F</span><span class="p">.</span><span class="n">nodesUps</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                    </span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">interscaling</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">frsyn</span><span class="p">=@(</span><span class="n">insig</span><span class="p">)</span><span class="w"> </span><span class="n">comp_iuwpfbt</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">coef2native</span><span class="p">(</span><span class="n">insig</span><span class="p">,</span><span class="nb">size</span><span class="p">(</span><span class="n">insig</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                  </span><span class="n">F</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">wtPath</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)),</span><span class="k">...</span><span class="w"></span>
<span class="w">                                  </span><span class="n">F</span><span class="p">.</span><span class="n">nodesUps</span><span class="p">(</span><span class="k">end</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">),</span><span class="n">F</span><span class="p">.</span><span class="n">pOutIdxs</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">chOutIdxs</span><span class="p">,</span><span class="k">...</span><span class="w"></span>
<span class="w">                                  </span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">scaling</span><span class="p">,</span><span class="n">F</span><span class="p">.</span><span class="n">flags</span><span class="p">.</span><span class="n">interscaling</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">length</span><span class="p">=@(</span><span class="n">Ls</span><span class="p">)</span><span class="w"> </span><span class="n">Ls</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span>
<span class="w">  </span><span class="c">%%%%%%%%%%%%%%%%%%%%</span><span class="w"></span>
<span class="w">  </span><span class="c">%% WRAPPER FRAMES %%</span><span class="w"></span>
<span class="w">  </span><span class="c">%%%%%%%%%%%%%%%%%%%%</span><span class="w"></span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;erbletfb&#39;</span><span class="p">,</span><span class="s">&#39;cqtfb&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;waveletfb&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;audletfb&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;warpedfb&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;gaborfb&#39;</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">switch</span><span class="p">(</span><span class="n">ftype</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;erbletfb&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">erbfilters</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{:});</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;cqtfb&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cqtfilters</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{:});</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;waveletfb&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">waveletfilters</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{:});</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;audletfb&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">waveletfilters</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{:});</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;warpedfb&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">waveletfilters</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{:});</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="s">&#39;gaborfb&#39;</span><span class="w"></span>
<span class="w">            </span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">L</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">waveletfilters</span><span class="p">(</span><span class="nb">varargin</span><span class="p">{:});</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="c">% Search for the &#39;complex&#39; flag</span><span class="w"></span>
<span class="w">    </span><span class="n">do_complex</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">~</span><span class="nb">isempty</span><span class="p">(</span><span class="nb">varargin</span><span class="p">(</span><span class="nb">strcmp</span><span class="p">(</span><span class="s">&#39;complex&#39;</span><span class="p">,</span><span class="nb">varargin</span><span class="p">)));</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">do_complex</span><span class="w"></span>
<span class="w">       </span><span class="n">F</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">frameaccel</span><span class="p">(</span><span class="n">frame</span><span class="p">(</span><span class="s">&#39;filterbank&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span><span class="n">L</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="w">       </span><span class="n">F</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">frameaccel</span><span class="p">(</span><span class="n">frame</span><span class="p">(</span><span class="s">&#39;filterbankreal&#39;</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="nb">numel</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span><span class="n">L</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">fixedlength</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="k">otherwise</span><span class="w"></span>
<span class="w">    </span><span class="nb">error</span><span class="p">(</span><span class="s">&#39;%s: Unknown frame type: %s&#39;</span><span class="p">,</span><span class="nb">upper</span><span class="p">(</span><span class="nb">mfilename</span><span class="p">),</span><span class="n">ftype</span><span class="p">);</span><span class="w">  </span>

<span class="k">end</span><span class="p">;</span><span class="w"></span>


<span class="c">% This one is placed at the end, to allow for F.red to be defined</span><span class="w"></span>
<span class="c">% first.</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">isfield</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="s">&#39;lengthcoef&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">.</span><span class="n">lengthcoef</span><span class="p">=@(</span><span class="n">Ncoef</span><span class="p">)</span><span class="w"> </span><span class="n">Ncoef</span><span class="o">/</span><span class="n">framered</span><span class="p">(</span><span class="n">F</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="p">;</span><span class="w"></span>
</pre></div>


        <div class="include" file="../../include/footer.html"></div>
    </div>
</div>
<!-- These two have to be here to dynamically load the included parts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script
src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.5/js/bootstrap-select.min.js"></script>
<script src="../../js/ltfat.js" type="text/javascript"></script>
<script src="../include/lookup.js" type="text/javascript"></script>
<script src="../include/jumplist.js" type="text/javascript"></script>
</body>
</html>

